ğŸ“ Konum TabanlÄ± GiriÅŸ-Ã‡Ä±kÄ±ÅŸ Takip Sistemi - Ä°mplementasyon PlanÄ±                                                                       â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ ğŸ¯ SeÃ§ilen YaklaÅŸÄ±m                                                                                                                     â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - Konum YÃ¶ntemi: Geofencing (BÃ¶lge tabanlÄ±)                                                                                             â”‚ â”‚
â”‚ â”‚ - Lokasyon Stratejisi: Her Ã§alÄ±ÅŸan tek lokasyona atanÄ±r                                                                                 â”‚ â”‚
â”‚ â”‚ - Senkronizasyon: Online/Offline hibrit (online varsa anÄ±nda, yoksa lokal kayÄ±t + sonra sync)                                           â”‚ â”‚
â”‚ â”‚ - Vardiya Entegrasyonu: HayÄ±r (basit giriÅŸ-Ã§Ä±kÄ±ÅŸ takibi)                                                                                â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ ---                                                                                                                                     â”‚ â”‚
â”‚ â”‚ ğŸ“± PART 1: iOS (Swift) - Mobile App Implementation                                                                                      â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 1. Core Components - Konum Servisleri                                                                                                   â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 1.1 LocationManager.swift (Core/Location/)                                                                                              â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - CLLocationManager wrapper oluÅŸturulacak                                                                                               â”‚ â”‚
â”‚ â”‚ - Geofencing region tanÄ±mlama ve izleme                                                                                                 â”‚ â”‚
â”‚ â”‚ - Konum izinleri yÃ¶netimi (Always/When In Use)                                                                                          â”‚ â”‚
â”‚ â”‚ - Background location updates                                                                                                           â”‚ â”‚
â”‚ â”‚ - Region enter/exit event handling                                                                                                      â”‚ â”‚
â”‚ â”‚ - Accuracy ve distance filter optimizasyonu                                                                                             â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 1.2 GeofenceManager.swift (Core/Location/)                                                                                              â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - Workspace lokasyonlarÄ± iÃ§in geofence tanÄ±mlama                                                                                        â”‚ â”‚
â”‚ â”‚ - Radius parametresi (Ã¶rn: 100-200 metre)                                                                                               â”‚ â”‚
â”‚ â”‚ - Multi-region monitoring desteÄŸi                                                                                                       â”‚ â”‚
â”‚ â”‚ - Region monitoring limitleri yÃ¶netimi (max 20 region)                                                                                  â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 2. Data Layer - Models & Storage                                                                                                        â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 2.1 Models (Modules/Attendance/Models/)                                                                                                 â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ // WorkplaceLocation.swift                                                                                                              â”‚ â”‚
â”‚ â”‚ - id, companyId, name, latitude, longitude, radius                                                                                      â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ // AttendanceLog.swift                                                                                                                  â”‚ â”‚
â”‚ â”‚ - id, personnelId, workplaceLocationId, eventType (CheckIn/CheckOut)                                                                    â”‚ â”‚
â”‚ â”‚ - timestamp, latitude, longitude, accuracy                                                                                              â”‚ â”‚
â”‚ â”‚ - isSynced, syncedAt, createdAt                                                                                                         â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ // AttendanceEventType.swift (Enum)                                                                                                     â”‚ â”‚
â”‚ â”‚ - checkIn, checkOut                                                                                                                     â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 2.2 Local Storage (Core/Storage/)                                                                                                       â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - CoreDataManager.swift geniÅŸletme                                                                                                      â”‚ â”‚
â”‚ â”‚   - AttendanceLog entity tanÄ±mÄ±                                                                                                         â”‚ â”‚
â”‚ â”‚   - Local queue iÃ§in CRUD operations                                                                                                    â”‚ â”‚
â”‚ â”‚   - Sync durumu takibi                                                                                                                  â”‚ â”‚
â”‚ â”‚ - AttendanceStorage.swift (yeni)                                                                                                        â”‚ â”‚
â”‚ â”‚   - Pending logs yÃ¶netimi                                                                                                               â”‚ â”‚
â”‚ â”‚   - Sync retry logic                                                                                                                    â”‚ â”‚
â”‚ â”‚   - Conflict resolution                                                                                                                 â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 3. Business Logic - Services & ViewModels                                                                                               â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 3.1 Services (Modules/Attendance/Services/)                                                                                             â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ AttendanceService.swift                                                                                                                 â”‚ â”‚
â”‚ â”‚ - GiriÅŸ-Ã§Ä±kÄ±ÅŸ kaydÄ± oluÅŸturma                                                                                                           â”‚ â”‚
â”‚ â”‚ - Backend API Ã§aÄŸrÄ±larÄ±                                                                                                                 â”‚ â”‚
â”‚ â”‚ - Offline queue yÃ¶netimi                                                                                                                â”‚ â”‚
â”‚ â”‚ - Background sync scheduler                                                                                                             â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ AttendanceLocationService.swift                                                                                                         â”‚ â”‚
â”‚ â”‚ - Workplace locations getirme                                                                                                           â”‚ â”‚
â”‚ â”‚ - Geofence kurulumu                                                                                                                     â”‚ â”‚
â”‚ â”‚ - Location validation                                                                                                                   â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 3.2 ViewModels (Modules/Attendance/ViewModels/)                                                                                         â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ AttendanceViewModel.swift                                                                                                               â”‚ â”‚
â”‚ â”‚ - Real-time location status                                                                                                             â”‚ â”‚
â”‚ â”‚ - GiriÅŸ-Ã§Ä±kÄ±ÅŸ butonu state management                                                                                                   â”‚ â”‚
â”‚ â”‚ - GeÃ§miÅŸ kayÄ±tlar listesi                                                                                                               â”‚ â”‚
â”‚ â”‚ - Sync status indicator                                                                                                                 â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ AttendanceHistoryViewModel.swift                                                                                                        â”‚ â”‚
â”‚ â”‚ - GÃ¼nlÃ¼k/haftalÄ±k/aylÄ±k kayÄ±t listesi                                                                                                   â”‚ â”‚
â”‚ â”‚ - Filtreleme ve arama                                                                                                                   â”‚ â”‚
â”‚ â”‚ - Export/rapor fonksiyonlarÄ±                                                                                                            â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 4. UI Layer - Views                                                                                                                     â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 4.1 Views (Modules/Attendance/Views/)                                                                                                   â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ AttendanceView.swift                                                                                                                    â”‚ â”‚
â”‚ â”‚ - Ana giriÅŸ-Ã§Ä±kÄ±ÅŸ ekranÄ±                                                                                                                â”‚ â”‚
â”‚ â”‚ - Konum durumu gÃ¶stergesi (in/out of range)                                                                                             â”‚ â”‚
â”‚ â”‚ - Manuel check-in/out butonlarÄ±                                                                                                         â”‚ â”‚
â”‚ â”‚ - BugÃ¼nkÃ¼ kayÄ±tlar Ã¶zeti                                                                                                                â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ AttendanceHistoryView.swift                                                                                                             â”‚ â”‚
â”‚ â”‚ - GeÃ§miÅŸ kayÄ±tlar listesi                                                                                                               â”‚ â”‚
â”‚ â”‚ - Tarih filtreleri                                                                                                                      â”‚ â”‚
â”‚ â”‚ - Detay modal                                                                                                                           â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ AttendanceMapView.swift (Optional)                                                                                                      â”‚ â”‚
â”‚ â”‚ - Workplace location harita gÃ¶rÃ¼nÃ¼mÃ¼                                                                                                    â”‚ â”‚
â”‚ â”‚ - Geofence boundary visualization                                                                                                       â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 5. Background Processing                                                                                                                â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 5.1 Background Tasks (Core/Background/)                                                                                                 â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - AttendanceBackgroundSync.swift                                                                                                        â”‚ â”‚
â”‚ â”‚   - BGTaskScheduler ile periyodik sync                                                                                                  â”‚ â”‚
â”‚ â”‚   - Offline kayÄ±tlarÄ± backend'e gÃ¶nderme                                                                                                â”‚ â”‚
â”‚ â”‚   - Retry logic                                                                                                                         â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 5.2 Notification Handler                                                                                                                â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - Geofence enter/exit notifications                                                                                                     â”‚ â”‚
â”‚ â”‚ - KullanÄ±cÄ± bilgilendirme                                                                                                               â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 6. Permissions & Configuration                                                                                                          â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 6.1 Info.plist Updates                                                                                                                  â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - NSLocationAlwaysAndWhenInUseUsageDescription                                                                                          â”‚ â”‚
â”‚ â”‚ - NSLocationWhenInUseUsageDescription                                                                                                   â”‚ â”‚
â”‚ â”‚ - UIBackgroundModes: location                                                                                                           â”‚ â”‚
â”‚ â”‚ - Privacy - Location Always Usage Description (TR/EN)                                                                                   â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 6.2 Capabilities                                                                                                                        â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - Background Modes â†’ Location updates                                                                                                   â”‚ â”‚
â”‚ â”‚ - Background fetch                                                                                                                      â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ ---                                                                                                                                     â”‚ â”‚
â”‚ â”‚ ğŸ–¥ï¸ PART 2: Backend (.NET) - HRService Implementatio                                                                                    â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 1. Domain Layer                                                                                                                         â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 1.1 Entities (HRService.Domain/Entities/)                                                                                               â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ WorkplaceLocation.cs                                                                                                                    â”‚ â”‚
â”‚ â”‚ - Id (Guid)                                                                                                                             â”‚ â”‚
â”‚ â”‚ - CompanyId (Guid)                                                                                                                      â”‚ â”‚
â”‚ â”‚ - Name (string)                                                                                                                         â”‚ â”‚
â”‚ â”‚ - Address (string)                                                                                                                      â”‚ â”‚
â”‚ â”‚ - Latitude (double)                                                                                                                     â”‚ â”‚
â”‚ â”‚ - Longitude (double)                                                                                                                    â”‚ â”‚
â”‚ â”‚ - Radius (int) - metre cinsinden                                                                                                        â”‚ â”‚
â”‚ â”‚ - IsActive, CreatedAt, UpdatedAt                                                                                                        â”‚ â”‚
â”‚ â”‚ - Soft delete fields                                                                                                                    â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ AttendanceLog.cs                                                                                                                        â”‚ â”‚
â”‚ â”‚ - Id (Guid)                                                                                                                             â”‚ â”‚
â”‚ â”‚ - CompanyId (Guid)                                                                                                                      â”‚ â”‚
â”‚ â”‚ - CrmPersonnelId (Guid)                                                                                                                 â”‚ â”‚
â”‚ â”‚ - WorkplaceLocationId (Guid)                                                                                                            â”‚ â”‚
â”‚ â”‚ - EventType (enum: CheckIn/CheckOut)                                                                                                    â”‚ â”‚
â”‚ â”‚ - Timestamp (DateTime)                                                                                                                  â”‚ â”‚
â”‚ â”‚ - Latitude (double) - kaydedilen konum                                                                                                  â”‚ â”‚
â”‚ â”‚ - Longitude (double)                                                                                                                    â”‚ â”‚
â”‚ â”‚ - Accuracy (double) - metre                                                                                                             â”‚ â”‚
â”‚ â”‚ - DeviceInfo (string) - iOS cihaz bilgisi                                                                                               â”‚ â”‚
â”‚ â”‚ - IsManual (bool) - manuel mi otomatik mi                                                                                               â”‚ â”‚
â”‚ â”‚ - Note (string, nullable)                                                                                                               â”‚ â”‚
â”‚ â”‚ - CreatedAt, UpdatedAt                                                                                                                  â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 1.2 Enums (HRService.Domain/Enums/)                                                                                                     â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ AttendanceEventType { CheckIn, CheckOut }                                                                                               â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 2. Application Layer                                                                                                                    â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 2.1 DTOs (HRService.Application/DTOs/)                                                                                                  â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ Attendance/                                                                                                                             â”‚ â”‚
â”‚ â”‚ - CreateAttendanceLogDto.cs                                                                                                             â”‚ â”‚
â”‚ â”‚ - GetAttendanceLogDto.cs                                                                                                                â”‚ â”‚
â”‚ â”‚ - GetAttendanceLogsByDateRangeDto.cs                                                                                                    â”‚ â”‚
â”‚ â”‚ - AttendanceLogResponseDto.cs                                                                                                           â”‚ â”‚
â”‚ â”‚ - BatchAttendanceLogDto.cs (offline sync iÃ§in)                                                                                          â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ WorkplaceLocation/                                                                                                                      â”‚ â”‚
â”‚ â”‚ - CreateWorkplaceLocationDto.cs                                                                                                         â”‚ â”‚
â”‚ â”‚ - UpdateWorkplaceLocationDto.cs                                                                                                         â”‚ â”‚
â”‚ â”‚ - GetWorkplaceLocationDto.cs                                                                                                            â”‚ â”‚
â”‚ â”‚ - GetAllWorkplaceLocationsDto.cs                                                                                                        â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 2.2 Services (HRService.Application/Services/)                                                                                          â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ AttendanceService.cs                                                                                                                    â”‚ â”‚
â”‚ â”‚ - CreateAttendanceLog(dto) - tek kayÄ±t                                                                                                  â”‚ â”‚
â”‚ â”‚ - CreateBatchAttendanceLogs(dtos) - offline sync iÃ§in bulk insert                                                                       â”‚ â”‚
â”‚ â”‚ - GetAttendanceLogsByPersonnel(personnelId, dateRange)                                                                                  â”‚ â”‚
â”‚ â”‚ - GetAttendanceLogsByCompany(companyId, filters)                                                                                        â”‚ â”‚
â”‚ â”‚ - ValidateAttendanceLocation(lat, lon, workplaceLocationId) - geofence validation                                                       â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ WorkplaceLocationService.cs                                                                                                             â”‚ â”‚
â”‚ â”‚ - CRUD operations                                                                                                                       â”‚ â”‚
â”‚ â”‚ - GetActiveLocationsByCompany(companyId)                                                                                                â”‚ â”‚
â”‚ â”‚ - AssignPersonnelToLocation(personnelId, locationId)                                                                                    â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 2.3 CQRS Commands/Queries (MediatR)                                                                                                     â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ Commands:                                                                                                                               â”‚ â”‚
â”‚ â”‚ - CreateAttendanceLogCommand                                                                                                            â”‚ â”‚
â”‚ â”‚ - CreateBatchAttendanceLogsCommand                                                                                                      â”‚ â”‚
â”‚ â”‚ - CreateWorkplaceLocationCommand                                                                                                        â”‚ â”‚
â”‚ â”‚ - UpdateWorkplaceLocationCommand                                                                                                        â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ Queries:                                                                                                                                â”‚ â”‚
â”‚ â”‚ - GetAttendanceLogsByPersonnelQuery                                                                                                     â”‚ â”‚
â”‚ â”‚ - GetAttendanceLogsByDateRangeQuery                                                                                                     â”‚ â”‚
â”‚ â”‚ - GetWorkplaceLocationsByCompanyQuery                                                                                                   â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 3. Infrastructure Layer                                                                                                                 â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 3.1 Repositories (HRService.Infrastructure/Repositories/)                                                                               â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - AttendanceLogRepository.cs                                                                                                            â”‚ â”‚
â”‚ â”‚ - WorkplaceLocationRepository.cs                                                                                                        â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 3.2 Database (Migrations)                                                                                                               â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - AddAttendanceLogsTable                                                                                                                â”‚ â”‚
â”‚ â”‚ - AddWorkplaceLocationsTable                                                                                                            â”‚ â”‚
â”‚ â”‚ - Indexes: CompanyId, CrmPersonnelId, Timestamp, EventType                                                                              â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 4. API Layer                                                                                                                            â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 4.1 Controllers (HRService.API/Controllers/)                                                                                            â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ AttendanceController.cs                                                                                                                 â”‚ â”‚
â”‚ â”‚ [Route("hr/attendance")]                                                                                                                â”‚ â”‚
â”‚ â”‚ POST /log - Tek giriÅŸ-Ã§Ä±kÄ±ÅŸ kaydÄ±                                                                                                       â”‚ â”‚
â”‚ â”‚ POST /log/batch - Bulk offline sync                                                                                                     â”‚ â”‚
â”‚ â”‚ GET /log/{personnelId} - KiÅŸiye ait kayÄ±tlar                                                                                            â”‚ â”‚
â”‚ â”‚ GET /log/company/{companyId} - Åirket raporu                                                                                            â”‚ â”‚
â”‚ â”‚ GET /log/daily/{personnelId}/{date} - GÃ¼nlÃ¼k Ã¶zet                                                                                       â”‚ â”‚
â”‚ â”‚ GET /log/range - Tarih aralÄ±ÄŸÄ± sorgulama                                                                                                â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ WorkplaceLocationController.cs                                                                                                          â”‚ â”‚
â”‚ â”‚ [Route("hr/workplace-location")]                                                                                                        â”‚ â”‚
â”‚ â”‚ POST /create                                                                                                                            â”‚ â”‚
â”‚ â”‚ PUT /update                                                                                                                             â”‚ â”‚
â”‚ â”‚ DELETE /delete/{id}                                                                                                                     â”‚ â”‚
â”‚ â”‚ GET /getById/{id}                                                                                                                       â”‚ â”‚
â”‚ â”‚ GET /getByCompany/{companyId}                                                                                                           â”‚ â”‚
â”‚ â”‚ GET /getActiveByCompany/{companyId}                                                                                                     â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 5. Validation & Business Rules                                                                                                          â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 5.1 Validations                                                                                                                         â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - AynÄ± kiÅŸinin 5 dakika iÃ§inde Ã§ift kayÄ±t kontrolÃ¼                                                                                      â”‚ â”‚
â”‚ â”‚ - Geofence radius iÃ§inde mi kontrolÃ¼                                                                                                    â”‚ â”‚
â”‚ â”‚ - CheckIn sonrasÄ± CheckOut kontrolÃ¼ (mantÄ±ksal sÄ±ralama)                                                                                â”‚ â”‚
â”‚ â”‚ - Tarih/saat manipÃ¼lasyon kontrolÃ¼                                                                                                      â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 5.2 Business Rules                                                                                                                      â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - GÃ¼nlÃ¼k max giriÅŸ-Ã§Ä±kÄ±ÅŸ sayÄ±sÄ± limiti (Ã¶rn: 10)                                                                                        â”‚ â”‚
â”‚ â”‚ - ÅÃ¼pheli aktivite tespiti (Ã§ok hÄ±zlÄ± giriÅŸ-Ã§Ä±kÄ±ÅŸ)                                                                                      â”‚ â”‚
â”‚ â”‚ - Location accuracy threshold (Ã¶rn: >50m ise uyarÄ±)                                                                                     â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ ---                                                                                                                                     â”‚ â”‚
â”‚ â”‚ ğŸ”„ PART 3: Integration & Sync Mechanism                                                                                                 â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 1. Senkronizasyon Stratejisi                                                                                                            â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ Online Mode:                                                                                                                            â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 1. Geofence event tetiklenir â†’ iOS                                                                                                      â”‚ â”‚
â”‚ â”‚ 2. AnÄ±nda AttendanceLog oluÅŸtur â†’ Local CoreData                                                                                        â”‚ â”‚
â”‚ â”‚ 3. Hemen API'ye POST /hr/attendance/log                                                                                                 â”‚ â”‚
â”‚ â”‚ 4. BaÅŸarÄ±lÄ±ysa isSynced = true, baÅŸarÄ±sÄ±zsa queue'ya ekle                                                                               â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ Offline Mode:                                                                                                                           â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 1. Network yoksa â†’ Local CoreData'ya kaydet (isSynced = false)                                                                          â”‚ â”‚
â”‚ â”‚ 2. Background task periyodik kontrol (15 dk)                                                                                            â”‚ â”‚
â”‚ â”‚ 3. Network gelince â†’ Batch sync: POST /hr/attendance/log/batch                                                                          â”‚ â”‚
â”‚ â”‚ 4. Backend validasyon + duplicate control                                                                                               â”‚ â”‚
â”‚ â”‚ 5. BaÅŸarÄ±lÄ± kayÄ±tlarÄ± isSynced = true yap                                                                                               â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 2. Conflict Resolution                                                                                                                  â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - Timestamp bazlÄ± unique constraint (personnelId + timestamp)                                                                           â”‚ â”‚
â”‚ â”‚ - Backend duplicate detection                                                                                                           â”‚ â”‚
â”‚ â”‚ - Client-side retry exponential backoff                                                                                                 â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ ---                                                                                                                                     â”‚ â”‚
â”‚ â”‚ ğŸ“Š PART 4: Testing & Quality Assurance                                                                                                  â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ iOS Tests                                                                                                                               â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - LocationManager unit tests (mock CLLocationManager)                                                                                   â”‚ â”‚
â”‚ â”‚ - GeofenceManager simÃ¼lasyonu                                                                                                           â”‚ â”‚
â”‚ â”‚ - AttendanceService offline/online scenario tests                                                                                       â”‚ â”‚
â”‚ â”‚ - CoreData migration tests                                                                                                              â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ Backend Tests                                                                                                                           â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - Unit tests: AttendanceService validations                                                                                             â”‚ â”‚
â”‚ â”‚ - Integration tests: API endpoints                                                                                                      â”‚ â”‚
â”‚ â”‚ - Load test: Batch sync performance                                                                                                     â”‚ â”‚
â”‚ â”‚ - Geofence validation accuracy test                                                                                                     â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ ---                                                                                                                                     â”‚ â”‚
â”‚ â”‚ ğŸš€ PART 5: Deployment & Rollout                                                                                                         â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ iOS                                                                                                                                     â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 1. Info.plist permissions ekle                                                                                                          â”‚ â”‚
â”‚ â”‚ 2. Background modes aktif et                                                                                                            â”‚ â”‚
â”‚ â”‚ 3. TestFlight beta test                                                                                                                 â”‚ â”‚
â”‚ â”‚ 4. App Store review (location permission aÃ§Ä±klamasÄ±)                                                                                    â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ Backend                                                                                                                                 â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 1. Migration scripts Ã§alÄ±ÅŸtÄ±r (test â†’ prod)                                                                                             â”‚ â”‚
â”‚ â”‚ 2. API endpoints deploy                                                                                                                 â”‚ â”‚
â”‚ â”‚ 3. Monitoring & logging setup (Hangfire/Serilog)                                                                                        â”‚ â”‚
â”‚ â”‚ 4. Performance metrics (response time, sync success rate)                                                                               â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ ---                                                                                                                                     â”‚ â”‚
â”‚ â”‚ ğŸ“ Dosya YapÄ±sÄ± (Ã–zet)                                                                                                                  â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ iOS (Swift)                                                                                                                             â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ camlica360/                                                                                                                             â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€ Core/                                                                                                                               â”‚ â”‚
â”‚ â”‚ â”‚   â”œâ”€â”€ Location/                                                                                                                       â”‚ â”‚
â”‚ â”‚ â”‚   â”‚   â”œâ”€â”€ LocationManager.swift                                                                                                       â”‚ â”‚
â”‚ â”‚ â”‚   â”‚   â””â”€â”€ GeofenceManager.swift                                                                                                       â”‚ â”‚
â”‚ â”‚ â”‚   â”œâ”€â”€ Storage/                                                                                                                        â”‚ â”‚
â”‚ â”‚ â”‚   â”‚   â”œâ”€â”€ CoreDataManager.swift (UPDATE)                                                                                              â”‚ â”‚
â”‚ â”‚ â”‚   â”‚   â””â”€â”€ AttendanceStorage.swift (NEW)                                                                                               â”‚ â”‚
â”‚ â”‚ â”‚   â””â”€â”€ Background/                                                                                                                     â”‚ â”‚
â”‚ â”‚ â”‚       â””â”€â”€ AttendanceBackgroundSync.swift (NEW)                                                                                        â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€ Modules/                                                                                                                            â”‚ â”‚
â”‚ â”‚ â”‚   â””â”€â”€ Attendance/ (NEW MODULE)                                                                                                        â”‚ â”‚
â”‚ â”‚ â”‚       â”œâ”€â”€ Models/                                                                                                                     â”‚ â”‚
â”‚ â”‚ â”‚       â”‚   â”œâ”€â”€ WorkplaceLocation.swift                                                                                                 â”‚ â”‚
â”‚ â”‚ â”‚       â”‚   â”œâ”€â”€ AttendanceLog.swift                                                                                                     â”‚ â”‚
â”‚ â”‚ â”‚       â”‚   â””â”€â”€ AttendanceEventType.swift                                                                                               â”‚ â”‚
â”‚ â”‚ â”‚       â”œâ”€â”€ Services/                                                                                                                   â”‚ â”‚
â”‚ â”‚ â”‚       â”‚   â”œâ”€â”€ AttendanceService.swift                                                                                                 â”‚ â”‚
â”‚ â”‚ â”‚       â”‚   â””â”€â”€ AttendanceLocationService.swift                                                                                         â”‚ â”‚
â”‚ â”‚ â”‚       â”œâ”€â”€ ViewModels/                                                                                                                 â”‚ â”‚
â”‚ â”‚ â”‚       â”‚   â”œâ”€â”€ AttendanceViewModel.swift                                                                                               â”‚ â”‚
â”‚ â”‚ â”‚       â”‚   â””â”€â”€ AttendanceHistoryViewModel.swift                                                                                        â”‚ â”‚
â”‚ â”‚ â”‚       â””â”€â”€ Views/                                                                                                                      â”‚ â”‚
â”‚ â”‚ â”‚           â”œâ”€â”€ AttendanceView.swift                                                                                                    â”‚ â”‚
â”‚ â”‚ â”‚           â”œâ”€â”€ AttendanceHistoryView.swift                                                                                             â”‚ â”‚
â”‚ â”‚ â”‚           â””â”€â”€ AttendanceMapView.swift (optional)                                                                                      â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ Backend (.NET)                                                                                                                          â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ HRService/                                                                                                                              â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€ Domain/                                                                                                                             â”‚ â”‚
â”‚ â”‚ â”‚   â”œâ”€â”€ Entities/                                                                                                                       â”‚ â”‚
â”‚ â”‚ â”‚   â”‚   â”œâ”€â”€ AttendanceLog.cs (NEW)                                                                                                      â”‚ â”‚
â”‚ â”‚ â”‚   â”‚   â””â”€â”€ WorkplaceLocation.cs (NEW)                                                                                                  â”‚ â”‚
â”‚ â”‚ â”‚   â””â”€â”€ Enums/                                                                                                                          â”‚ â”‚
â”‚ â”‚ â”‚       â””â”€â”€ AttendanceEventType.cs (NEW)                                                                                                â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€ Application/                                                                                                                        â”‚ â”‚
â”‚ â”‚ â”‚   â”œâ”€â”€ DTOs/Attendance/ (NEW)                                                                                                          â”‚ â”‚
â”‚ â”‚ â”‚   â”œâ”€â”€ DTOs/WorkplaceLocation/ (NEW)                                                                                                   â”‚ â”‚
â”‚ â”‚ â”‚   â”œâ”€â”€ Services/                                                                                                                       â”‚ â”‚
â”‚ â”‚ â”‚   â”‚   â”œâ”€â”€ AttendanceService.cs (NEW)                                                                                                  â”‚ â”‚
â”‚ â”‚ â”‚   â”‚   â””â”€â”€ WorkplaceLocationService.cs (NEW)                                                                                           â”‚ â”‚
â”‚ â”‚ â”‚   â””â”€â”€ Features/                                                                                                                       â”‚ â”‚
â”‚ â”‚ â”‚       â”œâ”€â”€ Attendance/Commands/ (NEW)                                                                                                  â”‚ â”‚
â”‚ â”‚ â”‚       â””â”€â”€ Attendance/Queries/ (NEW)                                                                                                   â”‚ â”‚
â”‚ â”‚ â”œâ”€â”€ Infrastructure/                                                                                                                     â”‚ â”‚
â”‚ â”‚ â”‚   â””â”€â”€ Repositories/                                                                                                                   â”‚ â”‚
â”‚ â”‚ â”‚       â”œâ”€â”€ AttendanceLogRepository.cs (NEW)                                                                                            â”‚ â”‚
â”‚ â”‚ â”‚       â””â”€â”€ WorkplaceLocationRepository.cs (NEW)                                                                                        â”‚ â”‚
â”‚ â”‚ â””â”€â”€ API/                                                                                                                                â”‚ â”‚
â”‚ â”‚     â””â”€â”€ Controllers/                                                                                                                    â”‚ â”‚
â”‚ â”‚         â”œâ”€â”€ AttendanceController.cs (NEW)                                                                                               â”‚ â”‚
â”‚ â”‚         â””â”€â”€ WorkplaceLocationController.cs (NEW)                                                                                        â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ ---                                                                                                                                     â”‚ â”‚
â”‚ â”‚ âš™ï¸ Teknik Detaylar                                                                                                                      â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ iOS Geofencing Best Practices:                                                                                                          â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - Minimum radius: 100m (Apple Ã¶nerisi)                                                                                                  â”‚ â”‚
â”‚ â”‚ - Maximum monitored regions: 20                                                                                                         â”‚ â”‚
â”‚ â”‚ - Battery optimization: Significant location change kullan                                                                              â”‚ â”‚
â”‚ â”‚ - Background mode: location aktif                                                                                                       â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ Backend Optimizations:                                                                                                                  â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ - Bulk insert iÃ§in EF Core BulkExtensions                                                                                               â”‚ â”‚
â”‚ â”‚ - Index: (CompanyId, CrmPersonnelId, Timestamp)                                                                                         â”‚ â”‚
â”‚ â”‚ - Pagination: BÃ¼yÃ¼k rapor sorgularÄ± iÃ§in                                                                                                â”‚ â”‚
â”‚ â”‚ - Caching: Workplace locations (Redis/Memory)                                                                                           â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ ---                                                                                                                                     â”‚ â”‚
â”‚ â”‚ ğŸ¯ Ä°mplementasyon SÄ±rasÄ±                                                                                                                â”‚ â”‚
â”‚ â”‚                                                                                                                                         â”‚ â”‚
â”‚ â”‚ 1. Backend Foundation (1-2 gÃ¼n)                                                                                                         â”‚ â”‚
â”‚ â”‚   - Entities + Migrations                                                                                                               â”‚ â”‚
â”‚ â”‚   - Basic CRUD APIs                                                                                                                     â”‚ â”‚
â”‚ â”‚ 2. iOS Core (2-3 gÃ¼n)                                                                                                                   â”‚ â”‚
â”‚ â”‚   - LocationManager + GeofenceManager                                                                                                   â”‚ â”‚
â”‚ â”‚   - CoreData models                                                                                                                     â”‚ â”‚
â”‚ â”‚ 3. iOS Business Logic (2 gÃ¼n)                                                                                                           â”‚ â”‚
â”‚ â”‚   - Services + ViewModels                                                                                                               â”‚ â”‚
â”‚ â”‚   - API integration                                                                                                                     â”‚ â”‚
â”‚ â”‚ 4. iOS UI (2 gÃ¼n)                                                                                                                       â”‚ â”‚
â”‚ â”‚   - Attendance screens                                                                                                                  â”‚ â”‚
â”‚ â”‚   - History & reporting                                                                                                                 â”‚ â”‚
â”‚ â”‚ 5. Sync Mechanism (1-2 gÃ¼n)                                                                                                             â”‚ â”‚
â”‚ â”‚   - Background tasks                                                                                                                    â”‚ â”‚
â”‚ â”‚   - Offline queue                                                                                                                       â”‚ â”‚
â”‚ â”‚ 6. Backend Advanced (1 gÃ¼n)                                                                                                             â”‚ â”‚
â”‚ â”‚   - Batch APIs                                                                                                                          â”‚ â”‚
â”‚ â”‚   - Validations                                                                                                                         â”‚ â”‚
â”‚ â”‚ 7. Testing & QA (2-3 gÃ¼n)                                                                                                               â”‚ â”‚
â”‚ â”‚   - Unit tests                                                                                                                          â”‚ â”‚
â”‚ â”‚   - Integration tests                                                                                                                   â”‚ â”‚
â”‚ â”‚   - Field testing 